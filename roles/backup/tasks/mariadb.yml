---
- name: Create .my.cnf file
  template:
    src: my.cnf.j2
    dest: "{{ app_base_path }}/.my.cnf"
    owner: "{{ app_user }}"
    group: "{{ app_user }}"
    mode: '0600'

- name: Check if mysqldump is available
  command: which mysqldump
  register: mysqldump_check
  changed_when: false
  failed_when: false

- name: Fail if mysqldump not installed
  fail:
    msg: "mysqldump not found. Please install mariadb-client or mysql-client manually."
  when: mysqldump_check.rc != 0
